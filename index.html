<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hope & Progress Tracker</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: { primary: "#E6F3FF", secondary: "#E8F5E9" },
            borderRadius: {
              none: "0px",
              sm: "4px",
              DEFAULT: "8px",
              md: "12px",
              lg: "16px",
              xl: "20px",
              "2xl": "24px",
              "3xl": "32px",
              full: "9999px",
              button: "8px",
            },
          },
        },
      };
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <style>
      :where([class^="ri-"])::before { content: "\f3c2"; }
      body {
      font-family: 'Inter', sans-serif;
      background-color: #FAFAFA;
      }
      .emoji-rating input[type="radio"] {
      display: none;
      }
      .emoji-rating label {
      cursor: pointer;
      transition: transform 0.2s ease, opacity 0.2s ease;
      }
      .emoji-rating input[type="radio"]:checked + label {
      transform: scale(1.1);
      opacity: 1;
      }
      .emoji-rating label:not(.selected) {
      opacity: 0.5;
      }
      .custom-shadow {
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
      }
      .gradient-card {
      background: linear-gradient(120deg, #E6F3FF 0%, #E8F5E9 100%);
      }
    </style>
  </head>
  <body>
    <div class="min-h-screen flex flex-col">
      <header class="bg-white shadow-sm sticky top-0 z-50">
        <div
          class="container mx-auto px-4 py-3 flex items-center justify-between"
        >
          <div class="flex items-center">
            <h1 class="text-2xl font-['Pacifico'] text-gray-800">Hope</h1>
          </div>
          <div class="flex items-center space-x-4">
            <div
              class="w-10 h-10 flex items-center justify-center rounded-full bg-primary text-gray-700 cursor-pointer"
            >
              <i class="ri-notification-3-line ri-lg"></i>
            </div>
            <div
              class="w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 cursor-pointer"
            >
              <i class="ri-user-line ri-lg"></i>
            </div>
          </div>
        </div>
      </header>
      <main class="flex-grow container mx-auto px-4 py-6">
        <div class="mb-8">
          <h2 class="text-2xl font-semibold text-gray-800">
            Good Morning, Emily
          </h2>
          <p class="text-gray-500">July 6, 2025 | Sunday</p>
        </div>
        <div class="flex justify-center mb-8">
          <button id="open-survey-btn" class="px-8 py-3 bg-primary text-gray-700 font-semibold rounded-button shadow hover:bg-blue-100 transition-colors text-lg">
            Fill Daily Health Survey
          </button>
        </div>
        <div class="bg-white rounded-lg custom-shadow p-6 mb-8">
          <h3 class="text-xl font-medium text-gray-800 mb-4">
            How are you feeling today?
          </h3>
          <div class="emoji-rating flex justify-between items-center mb-6">
            <input type="radio" name="feeling" id="feeling-1" value="1" />
            <label for="feeling-1" class="flex flex-col items-center">
              <div
                class="w-14 h-14 flex items-center justify-center bg-red-100 rounded-full mb-2"
              >
                <span class="text-2xl">üòû</span>
              </div>
              <span class="text-sm font-medium text-gray-700">Very Low</span>
            </label>
            <input type="radio" name="feeling" id="feeling-2" value="2" />
            <label for="feeling-2" class="flex flex-col items-center">
              <div
                class="w-14 h-14 flex items-center justify-center bg-orange-100 rounded-full mb-2"
              >
                <span class="text-2xl">üòî</span>
              </div>
              <span class="text-sm font-medium text-gray-700">Low</span>
            </label>
            <input type="radio" name="feeling" id="feeling-3" value="3" />
            <label for="feeling-3" class="flex flex-col items-center">
              <div
                class="w-14 h-14 flex items-center justify-center bg-yellow-100 rounded-full mb-2"
              >
                <span class="text-2xl">üòê</span>
              </div>
              <span class="text-sm font-medium text-gray-700">Neutral</span>
            </label>
            <input type="radio" name="feeling" id="feeling-4" value="4" />
            <label for="feeling-4" class="flex flex-col items-center">
              <div
                class="w-14 h-14 flex items-center justify-center bg-green-100 rounded-full mb-2"
              >
                <span class="text-2xl">üôÇ</span>
              </div>
              <span class="text-sm font-medium text-gray-700">Good</span>
            </label>
            <input type="radio" name="feeling" id="feeling-5" value="5" />
            <label for="feeling-5" class="flex flex-col items-center">
              <div
                class="w-14 h-14 flex items-center justify-center bg-blue-100 rounded-full mb-2"
              >
                <span class="text-2xl">üòä</span>
              </div>
              <span class="text-sm font-medium text-gray-700">Very Good</span>
            </label>
          </div>
          <div class="mb-4">
            <label
              for="notes"
              class="block text-sm font-medium text-gray-700 mb-1"
              >Any additional notes?</label
            >
            <textarea
              id="notes"
              rows="2"
              class="w-full px-4 py-2 border border-gray-200 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent resize-none"
              placeholder="Share how you're feeling today..."
            ></textarea>
          </div>
          <div class="flex justify-end">
            <button
              class="px-6 py-2 bg-primary text-gray-700 font-medium rounded-button hover:bg-blue-100 transition-colors whitespace-nowrap"
            >
              Save Entry
            </button>
          </div>
        </div>
        <div class="gradient-card rounded-lg custom-shadow p-6 mb-8">
          <div class="flex items-start">
            <div
              class="w-12 h-12 flex items-center justify-center bg-white rounded-full mr-4 flex-shrink-0"
            >
              <i class="ri-robot-line ri-lg text-blue-500"></i>
            </div>
            <div>
              <h3 class="text-lg font-medium text-gray-800 mb-1">
                Your Suggestion for Today
              </h3>
              <p class="text-gray-700 mb-4">
                Consider starting your day with a 5-minute breathing exercise.
                Research shows that deep breathing can help reduce stress and
                improve your overall mood. Would you like me to guide you
                through a simple breathing exercise?
              </p>
              <div class="flex space-x-3">
                <button
                  class="px-4 py-2 bg-white text-gray-700 font-medium rounded-button hover:bg-gray-50 transition-colors whitespace-nowrap"
                >
                  <i class="ri-thumb-up-line mr-1"></i> Helpful
                </button>
                <button
                  class="px-4 py-2 bg-white text-gray-700 font-medium rounded-button hover:bg-gray-50 transition-colors whitespace-nowrap"
                >
                  <i class="ri-refresh-line mr-1"></i> New Suggestion
                </button>
              </div>
            </div>
          </div>
        </div>
        <h3 class="text-xl font-medium text-gray-800 mb-4">Your Progress</h3>
        <div class="overflow-x-auto pb-2 mb-8">
          <div class="flex space-x-4" style="min-width: max-content;">
            <div class="bg-white rounded-lg custom-shadow p-4 w-64">
              <h4 class="text-sm font-medium text-gray-500 mb-2">
                Weekly Mood Trend
              </h4>
              <div class="h-32" id="weeklyMoodChart"></div>
            </div>
            <div class="bg-white rounded-lg custom-shadow p-4 w-64">
              <h4 class="text-sm font-medium text-gray-500 mb-2">
                Energy Levels
              </h4>
              <div class="h-32" id="energyLevelsChart"></div>
            </div>
            <div class="bg-white rounded-lg custom-shadow p-4 w-64">
              <h4 class="text-sm font-medium text-gray-500 mb-2">
                Next Appointment
              </h4>
              <div class="flex items-center mb-3">
                <div
                  class="w-10 h-10 flex items-center justify-center bg-primary rounded-full mr-3"
                >
                  <i class="ri-calendar-line ri-lg"></i>
                </div>
                <div>
                  <p class="font-medium text-gray-800">Dr. Sarah Johnson</p>
                  <p class="text-sm text-gray-500">Oncologist</p>
                </div>
              </div>
              <p class="text-sm text-gray-700">
                <i class="ri-time-line mr-1"></i> July 10, 2025 at 10:30 AM
              </p>
            </div>
            <div class="bg-white rounded-lg custom-shadow p-4 w-64">
              <h4 class="text-sm font-medium text-gray-500 mb-2">
                Achievements
              </h4>
              <div class="flex flex-wrap gap-2">
                <div
                  class="flex items-center justify-center w-12 h-12 bg-yellow-100 rounded-full"
                >
                  <i class="ri-medal-line ri-lg text-yellow-600"></i>
                </div>
                <div
                  class="flex items-center justify-center w-12 h-12 bg-green-100 rounded-full"
                >
                  <i class="ri-heart-pulse-line ri-lg text-green-600"></i>
                </div>
                <div
                  class="flex items-center justify-center w-12 h-12 bg-blue-100 rounded-full"
                >
                  <i class="ri-calendar-check-line ri-lg text-blue-600"></i>
                </div>
                <div
                  class="flex items-center justify-center w-12 h-12 bg-purple-100 rounded-full"
                >
                  <i class="ri-mental-health-line ri-lg text-purple-600"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
        <h3 class="text-xl font-medium text-gray-800 mb-4">Quick Access</h3>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
          <a
            href="progress.html"
            data-readdy="true"
            class="block"
          >
            <div
              class="bg-white rounded-lg custom-shadow p-6 hover:shadow-md transition-shadow"
            >
              <div
                class="w-12 h-12 flex items-center justify-center bg-primary rounded-full mb-4"
              >
                <i class="ri-line-chart-line ri-lg"></i>
              </div>
              <h4 class="text-lg font-medium text-gray-800 mb-2">
                My Past Data
              </h4>
              <p class="text-gray-600">
                View your historical mood and symptom data to track your
                progress over time.
              </p>
            </div>
          </a>
          <a
            href="information_library.html"
            data-readdy="true"
            class="block"
          >
            <div
              class="bg-white rounded-lg custom-shadow p-6 hover:shadow-md transition-shadow"
            >
              <div
                class="w-12 h-12 flex items-center justify-center bg-secondary rounded-full mb-4"
              >
                <i class="ri-book-open-line ri-lg"></i>
              </div>
              <h4 class="text-lg font-medium text-gray-800 mb-2">
                Information Library
              </h4>
              <p class="text-gray-600">
                Access helpful resources, articles, and tips to support your
                journey.
              </p>
            </div>
          </a>
          <div
            class="bg-white rounded-lg custom-shadow p-6 hover:shadow-md transition-shadow cursor-pointer"
          >
            <div
              class="w-12 h-12 flex items-center justify-center bg-yellow-100 rounded-full mb-4"
            >
              <i class="ri-team-line ri-lg"></i>
            </div>
            <h4 class="text-lg font-medium text-gray-800 mb-2">
              Support Network
            </h4>
            <p class="text-gray-600">
              Connect with your care team, family members, and support groups.
            </p>
          </div>
          <div
            class="bg-white rounded-lg custom-shadow p-6 hover:shadow-md transition-shadow cursor-pointer"
          >
            <div
              class="w-12 h-12 flex items-center justify-center bg-purple-100 rounded-full mb-4"
            >
              <i class="ri-book-mark-line ri-lg"></i>
            </div>
            <h4 class="text-lg font-medium text-gray-800 mb-2">
              Daily Journal
            </h4>
            <p class="text-gray-600">
              Record your thoughts, experiences, and reflections in a private
              journal.
            </p>
          </div>
        </div>
      </main>
      <div id="survey-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
        <div class="bg-white rounded-2xl custom-shadow p-8 w-full max-w-lg flex flex-col items-center relative animate-fade-in">
          <button id="close-survey-btn" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-2xl" title="Close">
            <i class="ri-close-line"></i>
          </button>
          <div id="progress-bar-container" class="w-full mb-8">
            <div class="flex justify-between mb-1">
              <span class="text-sm font-medium text-gray-700">Question <span id="current-question-number">1</span>/10</span>
              <span class="text-sm font-medium text-gray-500" id="progress-percentage">10%</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-3">
              <div id="progress-bar" class="h-3 rounded-full transition-all duration-300" style="width: 10%; background: linear-gradient(90deg, #f87171 0%, #fbbf24 50%, #4ade80 100%);"></div>
            </div>
          </div>
          <div id="question-card" class="w-full flex flex-col items-center">
            <h3 id="question-text" class="text-lg font-semibold text-gray-800 mb-6 text-center">Question goes here</h3>
            <div class="flex flex-col items-center w-full mb-6">
              <div id="slider-emoji" class="text-4xl mb-2">üòê</div>
              <input id="rating-slider" type="range" min="1" max="5" step="1" value="3" class="w-full max-w-xs h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider-colored" />
              <div class="flex justify-between w-full max-w-xs mt-2 text-xs font-medium text-gray-600">
                <span>Very Low</span>
                <span>Low</span>
                <span>Neutral</span>
                <span>High</span>
                <span>Very High</span>
              </div>
            </div>
            <button id="next-question-btn" class="px-6 py-2 bg-primary text-gray-700 font-medium rounded-button hover:bg-blue-100 transition-colors mt-2">Next</button>
          </div>
          <div id="ai-analysis-card" class="w-full flex flex-col items-center mt-8 hidden">
            <div class="w-12 h-12 flex items-center justify-center bg-primary rounded-full mb-4">
              <i class="ri-robot-line ri-lg text-gray-700"></i>
            </div>
            <h3 class="text-xl font-semibold text-gray-800 mb-2">AI Analysis & Suggestions</h3>
            <p class="text-gray-700 mb-4 text-center">
              AI suggestions loading...
            </p>
            <ul class="list-disc text-left text-gray-700 mb-4 pl-6">
              </ul>
            <button id="restart-btn" class="px-6 py-2 bg-primary text-gray-700 font-medium rounded-button hover:bg-blue-100 transition-colors mt-2">Start Again</button>
          </div>
        </div>
      </div>
      <style>
        .slider-colored::-webkit-slider-thumb {
          -webkit-appearance: none;
          appearance: none;
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: #fff;
          border: 3px solid #60a5fa;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transition: border 0.2s;
        }
        .slider-colored::-webkit-slider-thumb:hover {
          border: 3px solid #2563eb;
        }
        .slider-colored::-moz-range-thumb {
          width: 32px;
          height: 32px;
          border-radius: 50%;
          background: #fff;
          border: 3px solid #60a5fa;
          box-shadow: 0 2px 8px rgba(0,0,0,0.08);
          transition: border 0.2s;
        }
        .slider-colored::-moz-range-thumb:hover {
          border: 3px solid #2563eb;
        }
        .slider-colored {
          background: linear-gradient(90deg, #f87171 0%, #fbbf24 50%, #4ade80 100%);
        }
      </style>
      <footer class="bg-white shadow-lg py-3 mt-auto">
        <div class="container mx-auto px-4">
          <div class="flex justify-around">
            <div class="flex flex-col items-center">
              <div
                class="w-10 h-10 flex items-center justify-center rounded-full bg-primary text-gray-700"
              >
                <i class="ri-home-line ri-lg"></i>
              </div>
              
              <span class="text-xs font-medium text-gray-700 mt-1">Home</span>
            </div>
            <div class="flex flex-col items-center">
              <div
                class="w-10 h-10 flex items-center justify-center rounded-full text-gray-400"
              >
                <i class="ri-line-chart-line ri-lg"></i>
              </div>
              <span class="text-xs font-medium text-gray-400 mt-1"
                >Progress</span
              >
            </div>
            <div class="flex flex-col items-center">
              <div
                class="w-10 h-10 flex items-center justify-center rounded-full text-gray-400"
              >
                <i class="ri-book-open-line ri-lg"></i>
              </div>
              <span class="text-xs font-medium text-gray-400 mt-1"
                >Library</span
              >
            </div>
            <div class="flex flex-col items-center">
              <div
                class="w-10 h-10 flex items-center justify-center rounded-full text-gray-400"
              >
                <i class="ri-user-settings-line ri-lg"></i>
              </div>
              <span class="text-xs font-medium text-gray-400 mt-1"
                >Profile</span
              >
            </div>
          </div>
        </div>
      </footer>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.5.0/echarts.min.js"></script>
    <script id="emoji-rating-script">
      document.addEventListener("DOMContentLoaded", function () {
        const ratingLabels = document.querySelectorAll(".emoji-rating label");
        const ratingInputs = document.querySelectorAll(".emoji-rating input");
        ratingInputs.forEach((input, index) => {
          input.addEventListener("change", function () {
            ratingLabels.forEach((label) => label.classList.remove("selected"));
            if (this.checked) {
              ratingLabels[index].classList.add("selected");
            }
          });
        });
      });
    </script>
    <script id="charts-script">
      document.addEventListener("DOMContentLoaded", function () {
        // Weekly Mood Chart
        const weeklyMoodChart = echarts.init(
          document.getElementById("weeklyMoodChart"),
        );
        const weeklyMoodOption = {
          animation: false,
          grid: {
            top: 10,
            right: 10,
            bottom: 20,
            left: 40,
          },
          xAxis: {
            type: "category",
            data: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
            axisLine: {
              lineStyle: {
                color: "#E5E7EB",
              },
            },
            axisLabel: {
              color: "#6B7280",
              fontSize: 10,
            },
          },
          yAxis: {
            type: "value",
            min: 1,
            max: 5,
            interval: 1,
            axisLine: {
              show: false,
            },
            axisLabel: {
              color: "#6B7280",
              fontSize: 10,
            },
            splitLine: {
              lineStyle: {
                color: "#F3F4F6",
              },
            },
          },
          series: [
            {
              data: [3, 2, 3, 4, 3, 5, 4],
              type: "line",
              smooth: true,
              symbol: "none",
              lineStyle: {
                color: "rgba(87, 181, 231, 1)",
                width: 3,
              },
              areaStyle: {
                color: {
                  type: "linear",
                  x: 0,
                  y: 0,
                  x2: 0,
                  y2: 1,
                  colorStops: [
                    {
                      offset: 0,
                      color: "rgba(87, 181, 231, 0.2)",
                    },
                    {
                      offset: 1,
                      color: "rgba(87, 181, 231, 0.01)",
                    },
                  ],
                },
              },
            },
          ],
          tooltip: {
            trigger: "axis",
            backgroundColor: "rgba(255, 255, 255, 0.8)",
            borderColor: "#E5E7EB",
            textStyle: {
              color: "#1F2937",
            },
          },
        };
        weeklyMoodChart.setOption(weeklyMoodOption);
        // Energy Levels Chart
        const energyLevelsChart = echarts.init(
          document.getElementById("energyLevelsChart"),
        );
        const energyLevelsOption = {
          animation: false,
          grid: {
            top: 10,
            right: 10,
            bottom: 20,
            left: 40,
          },
          xAxis: {
            type: "category",
            data: ["Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"],
            axisLine: {
              lineStyle: {
                color: "#E5E7EB",
              },
            },
            axisLabel: {
              color: "#6B7280",
              fontSize: 10,
            },
          },
          yAxis: {
            type: "value",
            min: 1,
            max: 5,
            interval: 1,
            axisLine: {
              show: false,
            },
            axisLabel: {
              color: "#6B7280",
              fontSize: 10,
            },
            splitLine: {
              lineStyle: {
                color: "#F3F4F6",
              },
            },
          },
          series: [
            {
              data: [2, 3, 2, 3, 4, 3, 4],
              type: "bar",
              barWidth: "60%",
              itemStyle: {
                color: "rgba(141, 211, 199, 1)",
                borderRadius: [4, 4, 0, 0],
              },
            },
          ],
          tooltip: {
            trigger: "axis",
            backgroundColor: "rgba(255, 255, 255, 0.8)",
            borderColor: "#E5E7EB",
            textStyle: {
              color: "#1F2937",
            },
          },
        };
        energyLevelsChart.setOption(energyLevelsOption);
        // Handle window resize
        window.addEventListener("resize", function () {
          weeklyMoodChart.resize();
          energyLevelsChart.resize();
        });
      });
    </script>
    <script>
      // Survey questions in English
      const questions = [
        "How would you rate your mood today?",
        "How is your energy level?",
        "What is your level of pain/discomfort?",
        "How was your sleep quality?",
        "How was your appetite?",
        "How effective do you feel your medication is?",
        "How motivated were you to do daily activities?",
        "Did you feel the need for support?",
        "What was your level of anxiety/worry?",
        "How do you feel about your overall health?"
      ];
      const sliderEmojis = ["üòû", "üòî", "üòê", "üôÇ", "üòä"];
      const sliderLabels = ["Very Low", "Low", "Neutral", "High", "Very High"];
      let currentQuestion = 0;
      let answers = [];

      // Modal & survey elements
      const openSurveyBtn = document.getElementById("open-survey-btn");
      const surveyModal = document.getElementById("survey-modal");
      const closeSurveyBtn = document.getElementById("close-survey-btn");
      const questionText = document.getElementById("question-text");
      const progressBar = document.getElementById("progress-bar");
      const progressBarContainer = document.getElementById("progress-bar-container");
      const currentQuestionNumber = document.getElementById("current-question-number");
      const progressPercentage = document.getElementById("progress-percentage");
      const ratingSlider = document.getElementById("rating-slider");
      const sliderEmoji = document.getElementById("slider-emoji");
      const nextBtn = document.getElementById("next-question-btn");
      const questionCard = document.getElementById("question-card");
      const aiAnalysisCard = document.getElementById("ai-analysis-card");
      const restartBtn = document.getElementById("restart-btn");

      // AI suggestion elements
      const aiAnalysisText = aiAnalysisCard.querySelector("p");
      const aiAnalysisList = aiAnalysisCard.querySelector("ul");

      function showQuestion(index) {
        questionText.textContent = questions[index];
        currentQuestionNumber.textContent = index + 1;
        progressBar.style.width = `${((index + 1) / questions.length) * 100}%`;
        progressPercentage.textContent = `${Math.round(((index + 1) / questions.length) * 100)}%`;
        ratingSlider.value = 3;
        sliderEmoji.textContent = sliderEmojis[2];
        nextBtn.disabled = false;
      }

      ratingSlider.addEventListener("input", function() {
        const val = parseInt(ratingSlider.value);
        sliderEmoji.textContent = sliderEmojis[val - 1];
      });

      nextBtn.addEventListener("click", async function() {
        const val = parseInt(ratingSlider.value);
        answers[currentQuestion] = val;
        currentQuestion++;
        if (currentQuestion < questions.length) {
          showQuestion(currentQuestion);
        } else {
          // All questions answered, show analysis
          questionCard.classList.add("hidden");
          progressBarContainer.classList.add("hidden");
          aiAnalysisCard.classList.remove("hidden");
          // Show loading message
          aiAnalysisText.textContent = "AI suggestions loading...";
          aiAnalysisList.innerHTML = "";
          try {
            const result = await fetchAISuggestions(answers);
            // Display AI analysis and suggestions
            aiAnalysisText.textContent = result.analysis;
            // Clear and add new suggestions
            aiAnalysisList.innerHTML = ""; 
            result.suggestions.forEach(s => {
              const li = document.createElement("li");
              li.textContent = s;
              aiAnalysisList.appendChild(li);
            });
          } catch (error) {
            console.error("Error fetching AI suggestions:", error);
            aiAnalysisText.textContent = "Sorry, there was an issue fetching AI suggestions. Please try again later.";
            aiAnalysisList.innerHTML = "";
          }
        }
      });

      restartBtn.addEventListener("click", function() {
        currentQuestion = 0;
        answers = [];
        aiAnalysisCard.classList.add("hidden");
        questionCard.classList.remove("hidden");
        progressBarContainer.classList.remove("hidden");
        showQuestion(0);
      });

      openSurveyBtn.addEventListener("click", function() {
        surveyModal.classList.remove("hidden");
        currentQuestion = 0;
        answers = [];
        aiAnalysisCard.classList.add("hidden");
        questionCard.classList.remove("hidden");
        progressBarContainer.classList.remove("hidden");
        showQuestion(0);
      });

      closeSurveyBtn.addEventListener("click", function() {
        surveyModal.classList.add("hidden");
      });

      // Close modal on page load
      document.addEventListener("DOMContentLoaded", function() {
        surveyModal.classList.add("hidden");
      });

      // Smart Rule-Based AI System (100% Reliable)
      async function fetchAISuggestions(answers) {
        console.log("Using smart rule-based AI system...");
        
        // Calculate average score and analyze patterns
        const avgScore = answers.reduce((a, b) => a + b, 0) / answers.length;
        const moodScore = answers[0]; // How would you rate your mood today?
        const energyScore = answers[1]; // How is your energy level?
        const painScore = answers[2]; // What is your level of pain/discomfort?
        const sleepScore = answers[3]; // How was your sleep quality?
        const appetiteScore = answers[4]; // How was your appetite?
        const medicationScore = answers[5]; // How effective do you feel your medication is?
        const motivationScore = answers[6]; // How motivated were you to do daily activities?
        const supportScore = answers[7]; // Did you feel the need for support?
        const anxietyScore = answers[8]; // What was your level of anxiety/worry?
        const overallHealthScore = answers[9]; // How do you feel about your overall health?

        // Generate personalized analysis
        let analysis = "Based on your survey responses, here's my analysis: ";
        
        if (avgScore < 2.5) {
          analysis += "I notice you're experiencing some challenges today. Your scores indicate you may be having a difficult time with various aspects of your health and well-being.";
        } else if (avgScore < 4) {
          analysis += "You're showing moderate levels across different health indicators. There's room for improvement, but you're managing reasonably well.";
        } else {
          analysis += "Excellent! Your scores show you're doing very well across all health indicators. Keep up the great work!";
        }

        // Generate personalized suggestions based on specific scores
        let suggestions = [];

        // Mood-based suggestions
        if (moodScore <= 2) {
          suggestions.push("Consider talking to your healthcare provider about your mood. They can help you find strategies to improve your emotional well-being.");
        } else if (moodScore >= 4) {
          suggestions.push("Your positive mood is great! Try to maintain this by engaging in activities you enjoy and staying connected with loved ones.");
        }

        // Energy-based suggestions
        if (energyScore <= 2) {
          suggestions.push("Low energy can be challenging. Try to maintain a regular sleep schedule and consider light activities like short walks if approved by your doctor.");
        } else if (energyScore >= 4) {
          suggestions.push("Great energy levels! Use this energy to stay active and engaged with your daily activities.");
        }

        // Pain-based suggestions
        if (painScore >= 4) {
          suggestions.push("If you're experiencing significant pain, please contact your healthcare team. Don't hesitate to ask for help managing your symptoms.");
        }

        // Sleep-based suggestions
        if (sleepScore <= 2) {
          suggestions.push("Poor sleep can affect your overall health. Try establishing a bedtime routine and avoid screens before sleep.");
        }

        // Medication-based suggestions
        if (medicationScore <= 2) {
          suggestions.push("If your medication doesn't seem effective, discuss this with your healthcare provider. They can help adjust your treatment plan.");
        }

        // Support-based suggestions
        if (supportScore >= 4) {
          suggestions.push("It's completely normal to need support. Reach out to friends, family, or support groups. You don't have to go through this alone.");
        }

        // Anxiety-based suggestions
        if (anxietyScore >= 4) {
          suggestions.push("High anxiety can be overwhelming. Consider relaxation techniques like deep breathing or meditation. Your healthcare team can also help.");
        }

        // Fill remaining slots with general advice
        while (suggestions.length < 3) {
          if (avgScore < 2.5) {
            suggestions.push("Remember to be patient with yourself - healing and progress take time. Every small step forward counts.");
          } else if (avgScore < 4) {
            suggestions.push("Continue monitoring your symptoms and stay in regular contact with your healthcare team.");
          } else {
            suggestions.push("Keep up your positive habits and routines. You're doing great!");
          }
        }

        // Ensure exactly 3 suggestions
        suggestions = suggestions.slice(0, 3);

        return {
          analysis: analysis,
          suggestions: suggestions
        };
      }
    </script>
  </body>
</html>